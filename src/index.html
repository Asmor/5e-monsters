<!DOCTYPE html>
<html class="h-full">
<head>
	<title>Kobold Plus Fight Club - The first rule of Kobold Fight Club is 'Yip Yip!'</title>
	<meta charset="utf-8">
	<link rel="manifest" href="../manifest.json">
	<link rel="apple-touch-icon" href="images/logo.png" sizes="600x600">
	<link rel="icon" href="images/logo.png" sizes="600x600">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600" rel="stylesheet">
	<script defer src="js/app.js"></script>
<!--	<script defer src="https://unpkg.com/alpinejs@3.8.1/dist/cdn.min.js"></script>-->
<!--	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />-->
	<link href="css/styles.css" rel="stylesheet">

	<!-- Include Choices CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/>

	<!-- Include Choices JavaScript (latest) -->
	<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

	<script>
		// On page load or when changing themes, best to add inline in `head` to avoid FOUC
		if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
			window.theme = 'dark'
			document.documentElement.classList.add('dark')
		} else {
			window.theme = 'light'
			document.documentElement.classList.remove('dark')
			localStorage.theme = 'light'
		}

		window.toggleTheme = function() {
			let theme = (localStorage.theme === 'dark' ? 'light' : 'dark');
			window.theme = theme;
			localStorage.theme = theme;
			document.documentElement.classList.toggle('dark', theme === 'dark');

			return theme
		}
	</script>
</head>

<body class="h-full">
	<div
		class="min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-300"
		x-data="window.app()"
		@filters-changed.window="filtersChanged"
	>

		<div @click="window.toggleTheme()" class="absolute bottom-2 left-2 h-12 w-12 cursor-pointer text-gray-500 grid place-items-center bg-gray-100 border rounded border-gray-200 dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-700 dark:text-gray-300"><i class="fa fa-moon text-gray-800 dark:text-gray-300"></i></div>

		<nav class="bg-emerald-700 border-b border-gray-200 dark:border-gray-900" x-data="{ menu: false }">
			<div class="mx-auto px-4 sm:px-6 lg:px-6">
				<div class="flex justify-between h-16 w-full">
					<div class="flex">
						<div class="flex-shrink-0 flex items-center">
							<a href="" class="flex items-center">
								<img class="h-8 w-auto" src="images/header_logo.png" alt="Fantasy Calendar"> <span class="hidden md:inline pl-2 text-lg font-bold text-white">Kobold+ Fight Club</span>
							</a>
						</div>
					</div>
					<div class="hidden sm:flex text-white sm:-my-px sm:ml-6 sm:space-x-8 items-center">
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">Home</a>
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">Manage Encounters</a>
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">Manage Players</a>
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">Run Encounters</a>
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">Fantasy Calendar</a>
                        <a href="" class="inline-flex items-center px-1 pt-1 text-sm font-medium text-emerald-300 hover:text-white hover:border-gray-300">About</a>
					</div>
					<div class="-mr-2 flex items-center sm:hidden">
						<button class="inline-flex items-center justify-center p-2 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white" @click="menu = !menu">
							<span class="sr-only">Open main menu</span>
							<svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
							</svg>
							<svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
							</svg>
						</button>
					</div>
				</div>
			</div>

			<div class="transition-all duration-400 ease-in-out overflow-hidden md:hidden hidden" :class="{ 'block': menu, 'hidden': !menu }">
				<div class="pt-2 pb-3 space-y-1">
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">Home</a>
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">Manage Encounters</a>
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">Manage Players</a>
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">Run Encounters</a>
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">Fantasy Calendar</a>
					<a href="" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-primary-200 hover:text-white">About</a>
				</div>
			</div>
		</nav>

		<div class="flex py-4 sm:py-6 lg:py-8">
			<div class="hidden lg:flex flex-col pl-4 sm:pl-6 lg:pl-8 flex-shrink-0 w-[33rem] min-h-full">
				<div class="flex w-full border-b-2 dark:border-gray-700 pb-4">
					<div class="flex flex-col">
						<span class="text-3xl mb-2">Group Info</span>

						<div class="flex mb-2">
							<div class="w-16">
								<label class="block font-medium text-gray-700 dark:text-gray-300">Players</label>
							</div>
							<div class="w-16 ml-4">
								<label class="block font-medium text-gray-700 dark:text-gray-300">Level</label>
							</div>
						</div>

						<template x-for="(group, index) in party.groups">
							<div class="flex mb-2">
								<div class="w-16">
									<input type="number" min="1" x-model="group.players" class="shadow-sm focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600 rounded-md" value="4">
								</div>

								<div class="w-16 mx-4">
									<input type="number" min="1" x-model="group.level" class="shadow-sm focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600 rounded-md" value="4">
								</div>

								<button @click="party.remove_group(index)" x-show="index > 0" type="button" class="inline-flex items-center px-3 py-1 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none">
									<i class="fas fa-times"></i>
								</button>
							</div>
						</template>

						<button @click="party.add_group()" type="button" class="mt-3 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-800 dark:hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
							<i class="fas fa-plus mr-2"></i> Add Another Level
						</button>
					</div>

					<div class="flex flex-col text-right leading-3 flex-1">
						<p :class="encounter.actualDifficulty === 'Easy' ? 'font-semibold' : ''" class="mt-2">Easy: <span class="ml-2" x-text="formatNumber(party.experience.easy) + ' exp'"></span></p>
						<p :class="encounter.actualDifficulty === 'Medium' ? 'font-semibold' : ''" class="mt-2">Medium: <span class="ml-2" x-text="formatNumber(party.experience.medium) + ' exp'"></span></p>
						<p :class="encounter.actualDifficulty === 'Hard' ? 'font-semibold' : ''" class="mt-2">Hard: <span class="ml-2" x-text="formatNumber(party.experience.hard) + ' exp'"></span></p>
						<p :class="encounter.actualDifficulty === 'Deadly' ? 'font-semibold' : ''" class="mt-2">Deadly: <span class="ml-2" x-text="formatNumber(party.experience.deadly) + ' exp'"></span></p>
						<p class="mt-2 leading-10">Daily budget: <span class="ml-2" x-text="formatNumber(party.experience.daily) + ' exp'"></span></p>
					</div>
				</div>

				<div class="flex-col mt-2">
					<div class="flex w-full">
						<span class="text-3xl mb-2 grow">Encounter Info</span>

						<div class="self-center" @click.away="difficultySelectOpen = false">
							<span class="relative z-0 inline-flex shadow-sm rounded-md">
								<button x-text="(difficulty.slice(0,1).toUpperCase() + difficulty.slice(1))" @click="encounter.generateRandom()" type="button" class="relative inline-flex items-center px-4 py-2 rounded-l-md border disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500">
									Medium
								</button>
								<span class="-ml-px relative block">
									<button @click="difficultySelectOpen = !difficultySelectOpen" type="button" class="relative inline-flex items-center px-2 py-2 rounded-r-md border disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500" id="option-menu-button" aria-expanded="true" aria-haspopup="true">
										<span class="sr-only">Open options</span>
										<!-- Heroicon name: solid/chevron-down -->
										<svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
										<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
										</svg>
									</button>

									<div x-show="difficultySelectOpen" @click="difficultySelectOpen = false" class="origin-top-right absolute right-0 mt-2 -mr-1 rounded-md shadow-lg bg-white dark:bg-gray-700 ring-1 ring-black ring-opacity-5 focus:outline-none w-48" role="menu" aria-orientation="vertical" aria-labelledby="option-menu-button" tabindex="-1"
										 x-transition:enter="transition ease-out duration-100"
										 x-transition:enter-start="transform opacity-0 scale-95"
										 x-transition:enter-end="transform opacity-100 scale-100"
										 x-transition:leave="transition ease-in duration-75"
										 x-transition:leave-start="transform opacity-100 scale-100"
										 x-transition:leave-end="transform opacity-0 scale-95"
									>
										<div class="py-1" role="none">
										<!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
										<a href="#" @click="difficulty = 'easy'" :class="{ 'bg-emerald-500 dark:bg-emerald-700 text-white': difficulty == 'easy', 'text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-600': difficulty !== 'easy' }" class="block px-4 py-2 text-sm" role="menuitem" tabindex="-1" id="option-menu-item-0">
											Easy
										</a>

										<a href="#" @click="difficulty = 'medium'" :class="{ 'bg-emerald-500 dark:bg-emerald-700 text-white': difficulty == 'medium', 'text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-600': difficulty !== 'medium' }" class="block px-4 py-2 text-sm" role="menuitem" tabindex="-1" id="option-menu-item-1">
											Medium
										</a>

										<a href="#" @click="difficulty = 'hard'" :class="{ 'bg-emerald-500 dark:bg-emerald-700 text-white': difficulty == 'hard', 'text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-600': difficulty !== 'hard' }" class="block px-4 py-2 text-sm" role="menuitem" tabindex="-1" id="option-menu-item-2">
											Hard
										</a>

										<a href="#" @click="difficulty = 'deadly'" :class="{ 'bg-emerald-500 dark:bg-emerald-700 text-white': difficulty == 'deadly', 'text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-600': difficulty !== 'deadly' }" class="block px-4 py-2 text-sm" role="menuitem" tabindex="-1" id="option-menu-item-2">
											Deadly
										</a>
										</div>
									</div>
								</span>
							</span>
						</div>
					</div>

					<!-- This example requires Tailwind CSS v2.0+ -->
					<div>
						<label id="listbox-label" class="block text-sm font-medium text-gray-700 dark:text-gray-300"> Encounter type </label>
						<div class="mt-1 relative">
							<button @click="encounterTypeSelectOpen = true" type="button" class="bg-white dark:bg-gray-700 relative w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" aria-haspopup="listbox" aria-expanded="true" aria-labelledby="listbox-label">
								<span class="block truncate" x-text="encounter_type"></span>
								<span class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
									<!-- Heroicon name: solid/selector -->
									<svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
									  <path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
									</svg>
								  </span>
							</button>

							<ul x-show="encounterTypeSelectOpen" class="absolute z-10 mt-1 w-full bg-white dark:bg-gray-700 shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm" tabindex="-1" role="listbox" aria-labelledby="listbox-label" aria-activedescendant="listbox-option-3"
								x-transition:enter=""
								x-transition:enter-start=""
								x-transition:enter-end=""
								x-transition:leave="transition ease-in duration-100"
								x-transition:leave-start="opacity-100"
								x-transition:leave-end="opacity-0"
							>
								<template x-for="type of encounter_types">
									<!--
									  Select option, manage highlight styles based on mouseenter/mouseleave and keyboard navigation.

									  Highlighted: "text-white bg-indigo-600", Not Highlighted: "text-gray-900"
									-->
									<li @click="encounter_type = type.key; encounterTypeSelectOpen = false;" :class="{ 'text-white bg-emerald-600': encounter_type === type.key, 'text-gray-900 dark:text-gray-300': encounter_type !== type.key }" class="text-gray-900 hover:text-white hover:bg-emerald-600 cursor-default select-none relative py-2 pl-3 pr-9" id="listbox-option-0" role="option">
										<!-- Selected: "font-semibold", Not Selected: "font-normal" -->
										<span class="font-normal block truncate" x-text="type.label"> </span>

										<span :class="{ 'text-white': encounter_type === type.key, 'text-emerald-600': encounter_type !== type.key }" class="absolute inset-y-0 right-0 flex items-center pr-4">
										  <!-- Heroicon name: solid/check -->
										  <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
											<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
										  </svg>
										</span>
									</li>
								</template>
							</ul>
						</div>
					</div>

					<select x-model="encounter_type">
						<template x-for="encounter of encounter_types">
							<option :selected="encounter_type === encounter.key" :value="encounter.key" x-text="encounter.label"></option>
						</template>
					</select>

					<div class="flex-row mt-2">
						<template x-for="(group, index) in encounter.groups" :key="group.monster.id">
							<div class="flex flex-row w-full mb-8">
								<div class="grow pb-2 min-w-0">
									<span class="text-3xl font-light" x-text="group.monster.name"></span>
									<div>
										<span class="text-lg" x-text="'CR: ' + group.monster.cr.string"></span>
										<span class="text-lg ml-4" x-text="'XP: ' + formatNumber(group.monster.cr.exp)"></span>
										<div class='overflow-hidden whitespace-nowrap overflow-ellipsis'>
											<ul class="list-none text-s italic">
											<template x-for="source in group.monster.sources">
												<li x-html="source.link ? `<a class='primary-link' href='${source.link}' target='_blank'>${source.fullText}</a>` : source.fullText"></li>
											</template>
											</ul>
										</div>
									</div>
								</div>
								<div class="">
									<button type="button" @click="encounter.getNewMonster(group)" class="dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 dark:text-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
										<i class="fas fa-random"></i>
									</button>
									<input type="number" min="1" class="inline align-middle w-24 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm border-gray-300 rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300" x-model="group.count"/>
									<div class="inline-block align-middle">
										<button @click="group.count++" type="button" class="block items-center p-1 mb-1 border border-transparent text-xs font-medium rounded text-emerald-700 dark:text-emerald-200 bg-emerald-100 dark:bg-emerald-800 hover:bg-emerald-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
											<i class="fas fa-plus"></i>
										</button>
										<button @click="encounter.subtractCount(group)" type="button" class="block items-center p-1 border border-transparent text-xs font-medium rounded text-red-700 dark:text-red-200 bg-red-100 dark:bg-red-800 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
											<i class="fas fa-minus"></i>
										</button>
									</div>
								</div>
							</div>
						</template>
					</div>

					<div class="flex border-t text-2xl border-t-gray-400 pt-4">
						<div class="grow">
							<div x-text="'Difficulty: ' + encounter.actualDifficulty"></div>
							<div class="text-sm" x-show="encounter.difficultyFeel" x-text="encounter.difficultyFeel"></div>
						</div>
						<div class="text-right">
							<span class="block">
								<span x-text="'Total XP: ' + encounter.totalExp"></span>
								<span class="text-base italic block" x-text="'(' + Math.round(encounter.totalExp / party.totalPlayers) + ' per player)'"></span>
							</span>
							<span class="block">
								<span x-text="'Adjusted XP: ' + encounter.adjustedExp"></span>
								<span class="text-base italic block" x-text="'(' + Math.round(encounter.adjustedExp / party.totalPlayers) + ' per player)'"></span>
							</span>
						</div>
					</div>
				</div>
			</div>

			<div class="flex-auto w-8/12 min-h-full">
				<div class="flex">
					<div class="grow">
						<div>
							<label for="search" class="block text-sm font-medium text-gray-700 sr-only">Search monsters</label>

							<div class="mt-1 flex rounded-md shadow-sm px-4 sm:px-6 lg:px-8">
								<div class="relative flex items-stretch flex-grow focus-within:z-10">
									<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
										<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
											<path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
										</svg>
									</div>

									<input type="search" name="search" id="search" x-model="search" @input.debounce="updateFilteredMonsters" class="border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 block w-full rounded-none rounded-l-md pl-10 sm:text-sm disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600" :placeholder="searchPlaceholder">
								</div>
								<div class="relative inline-block text-left" x-data="{ filtersMenu: true }">
									<div>
										<button @click="showFilters =! showFilters" type="button" class="-ml-px relative inline-flex items-center space-x-2 px-4 py-2 border border-gray-300 text-sm font-medium rounded-r-md bg-white disabled:text-gray-500 disabled:bg-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500">
											<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
												<path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
											</svg>
											<span>Filter</span>
											<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-300 text-gray-800" x-show="nonDefaultFiltersCount > 0" x-text="nonDefaultFiltersCount"></span>
										</button>
									</div>
								</div>
							</div>

							<div class="px-4 sm:px-6 lg:px-8">
								<div class="mt-8 flex flex-col">
									<div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
										<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8 max-w-full">
											<div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
												<table class="min-w-full divide-y divide-gray-300 dark:divide-gray-700">
													<thead class="bg-gray-50 dark:bg-gray-600">
													<tr>
														<th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">
															<span class="sr-only">Add to encounter</span>
														</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">Name</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">CR</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">Size</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">Type</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">Alignment</th>
														<th scope="col" class="px-3 py-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-300">Source</th>
													</tr>
													</thead>
													<tbody>
													<template x-for="monster in monsters">
														<tr class="odd:bg-gray-50 even:bg-gray-100 dark:odd:bg-gray-700 dark:even:bg-gray-800">
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300 text-center">
																<span class="primary-link cursor-pointer select-none" @click="encounter.addMonster(monster)">Add</span>
															</td>
															<td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 dark:text-gray-100 sm:pl-6" x-text="monster.name"></td>
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300" x-text="monster.cr.string"></td>
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300" x-text="monster.size"></td>
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300" x-text="monster.type"></td>
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300" x-text="monster.alignment.string"></td>
															<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-300">
																<ul class="list-none">
																	<template x-for="source in monster.sources">
																		<li x-text="source.book + (source.page ? ' p.' + source.page : '')"></li>
																	</template>
																</ul>
															</td>
														</tr>
													</template>
													</tbody>
												</table>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- This example requires Tailwind CSS v2.0+ -->
					<div class="fixed inset-0 z-50 overflow-hidden" aria-labelledby="slide-over-title" role="dialog" aria-modal="true" x-show="showFilters" x-cloak>
						<div class="absolute inset-0 overflow-hidden">
							<!-- Background overlay, show/hide based on slide-over state. -->
							<div @click="showFilters = false" class="absolute inset-0 bg-gray-500 dark:bg-gray-900 dark:bg-opacity-75 bg-opacity-75 transition-opacity" aria-hidden="true"
								 x-transition:enter="ease-in-out duration-200"
								 x-transition:enter-start="opacity-0"
								 x-transition:enter-end="opacity-100"
								 x-transition:leave="ease-in-out duration-200"
								 x-transition:leave-start="opacity-100"
								 x-transition:leave-end="opacity-0"
								 x-show="showFilters"
							></div>

							<div class="pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10">
								<div class="pointer-events-auto w-screen max-w-md"
									 x-transition:enter="transform transition ease-in-out duration-200 sm:duration-700"
									 x-transition:enter-start="translate-x-full"
									 x-transition:enter-end="translate-x-0"
									 x-transition:leave="transform transition ease-in-out duration-200 sm:duration-700"
									 x-transition:leave-start="translate-x-0"
									 x-transition:leave-end="translate-x-full"
									 x-show="showFilters"
								>
									<div class="flex h-full flex-col overflow-y-auto bg-white dark:bg-gray-800 py-6 shadow-xl">
										<div class="px-4 sm:px-6 border-b dark:border-gray-700 pb-6">
											<div class="flex items-start justify-between">
												<h2 class="text-lg font-medium text-gray-900 dark:text-gray-200" id="slide-over-title">Filter monsters</h2>
												<div class="ml-3 flex h-7 items-center">
													<button @click="showFilters = false" type="button" class="rounded-md bg-white dark:bg-gray-800 text-gray-400 dark:text-gray-500 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
														<span class="sr-only">Close panel</span>
														<!-- Heroicon name: outline/x -->
														<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
															<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
														</svg>
													</button>
												</div>
											</div>
										</div>
										<div class="relative mt-6 flex-1 px-4 sm:px-6 space-y-4">
											<div x-data="{ minCr: 0, maxCr: 0 }">
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">
													Challenge Rating
												</div>

												<div class="relative px-6 pt-1 pb-2 bg-white border border-gray-300 dark:bg-gray-700 dark:border-gray-600 rounded-md">

													<div x-ref="cr_slider" class="my-4 mx-2" x-data="multiSlider($el, 'challenge_rating', [
															{ value: '0', label: '0' },
															{ value: '1/8', label: '1/8' },
															{ value: '1/4', label: '1/4' },
															{ value: '1/2', label: '1/2' },
															{ value: '1', label: '1' },
															{ value: '2', label: '2' },
															{ value: '3', label: '3' },
															{ value: '4', label: '4' },
															{ value: '5', label: '5' },
															{ value: '6', label: '6' },
															{ value: '7', label: '7' },
															{ value: '8', label: '8' },
															{ value: '9', label: '9' },
															{ value: '10', label: '10' },
															{ value: '11', label: '11' },
															{ value: '12', label: '12' },
															{ value: '13', label: '13' },
															{ value: '14', label: '14' },
															{ value: '15', label: '15' },
															{ value: '16', label: '16' },
															{ value: '17', label: '17' },
															{ value: '18', label: '18' },
															{ value: '19', label: '19' },
															{ value: '20', label: '20' },
															{ value: '21', label: '21' },
															{ value: '22', label: '22' },
															{ value: '23', label: '23' },
															{ value: '24', label: '24' },
															{ value: '25', label: '25' },
															{ value: '26', label: '26' },
															{ value: '27', label: '27' },
															{ value: '28', label: '28' },
															{ value: '29', label: '29' },
															{ value: '30', label: '30' }
														], (lower, upper) => {
															minCr = lower;
															maxCr = upper;
														})"
														 @set-cr-slider.window="set($event)"
														 @reset-cr-slider.window="reset()"
													></div>

													<div class="grid place-items-center">
														<div x-show="minCr.value == 0 && maxCr.value == 30">Any CR</div>
														<div x-show="(minCr.value != 0 || maxCr.value != 30) && (minCr.value !== maxCr.value)">
															CR between <span x-text="minCr.label"></span> and <span x-text="maxCr.label"></span>
														</div>
														<div x-show="minCr.value == maxCr.value">CR is exactly <span x-text="minCr.label"></span></div>
													</div>

													<span @click="$dispatch('reset-cr-slider')" x-show="!(minCr.value == 0 && maxCr.value == 30)" class="absolute bottom-1 right-6 cursor-pointer">
														<i class="fa fa-undo h-6 w-6 text-gray-800 dark:text-gray-300"></i>
													</span>
												</div>
											</div>


											<div>
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">
													Alignment
												</div>

												<div class="grid grid-cols-[12px_12px_repeat(12,_minmax(0,_1fr))] divide divide-gray-200 dark:divide-gray-600 gap-2 rounded-md bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 overflow-hidden p-2" x-data="{
													lawful_good: 1,
													neutral_good: 2,
													chaotic_good: 4,
													lawful_neutral: 8,
													neutral: 16,
													chaotic_neutral: 32,
													lawful_evil: 64,
													neutral_evil: 128,
													chaotic_evil: 256,
													total: $persist(1023).as('alignment'),
													randomIconIndex: 0,
													icons: [
															'fa-solid fa-dumpster-fire',
															'fa-solid fa-poo-storm',
															'fa-solid fa-meteor',
															'fa-solid fa-arrows-split-up-and-left',
															'fa-solid fa-arrows-turn-to-dots',
															'fa-solid fa-candy-cane',
															'fa-solid fa-stroopwafel',
															'fa-solid fa-cake-candles',
															'fa-solid fa-bowling-ball',
															'fa-solid fa-bath',
															'fa-solid fa-bomb',
															'fa-solid fa-business-time',
															'fa-solid fa-dragon',
															'fa-solid fa-arrow-up-right-dots',
															'fa-solid fa-fire',
															'fa-solid fa-arrows-to-circle',
															'fa-solid fa-cloud-meatball',
															'fa-solid fa-arrows-down-to-people',
															'fa-solid fa-person-walking-arrow-loop-left',
															'fa-solid fa-person-walking-dashed-line-arrow-right',
														],
													init() {
														this.$watch('total', (total) => {
															let newIndex = Math.floor(Math.random() * this.icons.length);
															this.randomIconIndex = (newIndex === this.randomIconIndex) ? (newIndex + 1) % this.icons.length : newIndex;
															this.onFiltersChanged();
														});
														this.onFiltersChanged();
													},
													onFiltersChanged() {
														window.dispatchEvent(new CustomEvent('filters-changed', { detail: { name: 'alignment', value: this.total }}));
													},
													get randomIcon() {
														return this.icons[this.randomIconIndex];
													},
													toggle(value) {
														this.total = ((this.total & value) > 0) ? ((this.total | value) ^ value) : (this.total | value);
													},
													classes(value) {
														return {
															'bg-emerald-600 dark:bg-emerald-800 dark:hover:bg-emerald-900': this.total & value,
															'bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border': !(this.total & value),
															'cursor-pointer grid place-items-center text-center select-none text-gray-900 dark:text-white': true,
														};
													}
												}">
													<div @click="toggle((lawful_good | neutral | chaotic_evil))" :class="classes(lawful_good | neutral | chaotic_evil)" class="col-span-2 rounded-tl-md dark:border-gray-600"></div>
													<div @click="toggle((lawful_good | lawful_neutral | lawful_evil))" :class="classes(lawful_good | lawful_neutral | lawful_evil)" class="col-span-4 h-8 rounded-t-md"><i class="fa fa-gavel"></i></div>
													<div @click="toggle((neutral_good | neutral | neutral_evil))" :class="classes(neutral_good | neutral | neutral_evil)" class="col-span-4 h-8 rounded-t-md"><i class="fa fa-scale-balanced"></i></div>
													<div @click="toggle((chaotic_good | chaotic_neutral | chaotic_evil))" :class="classes(chaotic_good | chaotic_neutral | chaotic_evil)" class="col-span-4 h-8 rounded-t-md"><i :class="{ [randomIcon]: true }"></i></div>

													<div @click="toggle((lawful_good | neutral_good | chaotic_good))" :class="classes(lawful_good | neutral_good | chaotic_good)" class="col-span-2 w-8 rounded-l-md"><i class="fa fa-dove"></i></div>
													<div @click="toggle(lawful_good)" :class="classes(lawful_good)" class="col-span-4 h-16" title="Lawful Good">LG</div>
													<div @click="toggle(neutral_good)" :class="classes(neutral_good)" class="col-span-4 h-16" title="Neutral Good">NG</div>
													<div @click="toggle(chaotic_good)" :class="classes(chaotic_good)" class="col-span-4 h-16" title="Chaotic Good">CG</div>

													<div @click="toggle((lawful_neutral | neutral | chaotic_neutral))" :class="classes(lawful_neutral | neutral | chaotic_neutral)" class="col-span-2 w-8 rounded-l-md"><i class="fa fa-face-meh"></i></div>
													<div @click="toggle(lawful_neutral)" :class="classes(lawful_neutral)" class="col-span-4 h-16" title="Lawful Neutral">LN</div>
													<div @click="toggle(neutral)" :class="classes(neutral)" class="col-span-4 h-16" title="Neutral">N</div>
													<div @click="toggle(chaotic_neutral)" :class="classes(chaotic_neutral)" class="col-span-4 h-16" title="Chaotic Neutral">CN</div>

													<div @click="toggle((lawful_evil | neutral_evil | chaotic_evil))" :class="classes(lawful_evil | neutral_evil | chaotic_evil)" class="col-span-2 w-8 rounded-l-md"><i class="fa fa-skull"></i></div>
													<div @click="toggle(lawful_evil)" :class="classes(lawful_evil)" class="col-span-4 h-16" title="Lawful Evil">LE</div>
													<div @click="toggle(neutral_evil)" :class="classes(neutral_evil)" class="col-span-4 h-16" title="Neutral Evil">NE</div>
													<div @click="toggle(chaotic_evil)" :class="classes(chaotic_evil)" class="col-span-4 h-16" title="Chaotic Evil">CE</div>

													<div @click="toggle((lawful_evil | neutral | chaotic_good))" :class="classes(lawful_evil | neutral | chaotic_good)" class="col-span-2 rounded-bl-md"></div>
													<div @click="total = (total === 1023) ? 0 : 1023" :class="{ 'bg-emerald-600 dark:bg-emerald-800 dark:hover:bg-emerald-900': (total & 1023) === 1023, 'bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border': (total & 1023) !== 1023 }" class="select-none text-gray-900 dark:text-white col-span-6 cursor-pointer grid place-items-center h-8 bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border">Any</div>
													<div @click="total = total ^ 512" :class="{ 'bg-emerald-600 dark:bg-emerald-800 dark:hover:bg-emerald-900': (total & 512) === 512, 'bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border': (total & 512) !== 512 }" class="select-none text-gray-900 dark:text-white rounded-br-md col-span-6 cursor-pointer grid place-items-center h-8 bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border">Unaligned</div>
												</div>
											</div>


											<!-- Multi Select -->
											<div>
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Size category</div>

												<div @mousedown.stop x-data="multiSelect($refs.sizes, 'size', [
													{value: 'any', label: 'Any Size' },
													{value: 'tiny', label: 'Tiny' },
													{value: 'small', label: 'Small' },
													{value: 'medium', label: 'Medium' },
													{value: 'large', label: 'Large' },
													{value: 'huge', label: 'Huge' },
													{value: 'gargantuan', label: 'Gargantuan' }
												])">
													<select x-ref="sizes" :multiple="multiple" class="inline-block mb-2 mr-2 mt-1 w-auto pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md"></select>
												</div>
											</div>

											<div>
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Creature type</div>

												<div @mousedown.stop x-data="multiSelect($refs.creature_type, 'type', [
													{ value: 'any', label: 'Any Type' },
													{ value: 'aberration', label: 'Aberration' },
													{ value: 'beast', label: 'Beast' },
													{ value: 'celestial', label: 'Celestial' },
													{ value: 'construct', label: 'Construct' },
													{ value: 'dragon', label: 'Dragon' },
													{ value: 'elemental', label: 'Elemental' },
													{ value: 'fey', label: 'Fey' },
													{ value: 'fiend', label: 'Fiend' },
													{ value: 'giant', label: 'Giant' },
													{ value: 'humanoid', label: 'Humanoid' },
													{ value: 'monstrosity', label: 'Monstrosity' },
													{ value: 'ooze', label: 'Ooze' },
													{ value: 'plant', label: 'Plant' },
													{ value: 'undead', label: 'Undead' },
												])">
													<select x-ref="creature_type" multiple class="inline-block mb-2 mr-2 mt-1 w-auto pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md"></select>
												</div>
											</div>

											<div>
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Native environment</div>

												<div @mousedown.stop x-data="multiSelect($refs.environment, 'environment', [
													{ value: 'any', label: 'Any Environment' },
													{ value: 'aquatic', label: 'Aquatic' },
													{ value: 'arctic', label: 'Arctic' },
													{ value: 'cave', label: 'Cave' },
													{ value: 'coast', label: 'Coast' },
													{ value: 'desert', label: 'Desert' },
													{ value: 'dungeon', label: 'Dungeon' },
													{ value: 'forest', label: 'Forest' },
													{ value: 'grassland', label: 'Grassland' },
													{ value: 'mountain', label: 'Mountain' },
													{ value: 'planar', label: 'Planar' },
													{ value: 'ruins', label: 'Ruins' },
													{ value: 'swamp', label: 'Swamp' },
													{ value: 'underground', label: 'Underground' },
													{ value: 'urban', label: 'Urban' },
												])">
													<select x-ref="environment" multiple class="inline-block mb-2 mr-2 mt-1 w-auto pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md"></select>
												</div>
											</div>

											<div>
												<div class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Legendary Status</div>

												<div @mousedown.stop x-data="multiSelect($refs.legendary, 'legendary', [
													{ value: 'any', label: 'Any Legendary'},
													{ value: 'ordinary', label: 'Ordinary'},
													{ value: 'legendary', label: 'Legendary'},
													{ value: 'legendary_lair', label: 'Legendary (in lair)'},
												])">
													<select x-ref="legendary" multiple class="inline-block mb-2 mr-2 mt-1 w-auto pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md"></select>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
